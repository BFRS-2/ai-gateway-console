"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3979],{19478:function(t,e,r){r.d(e,{D7:function(){return l},Xt:function(){return c},yn:function(){return p},Ww:function(){return d}});class n{throwError(){return{status:!1,error:{type:"fe_err",message:this.error}}}constructor(t){this.error=t}}class o{throwError(){return{status:!1,error:{type:"api_err",message:this.error}}}constructor(t){this.error=t}}var i=r(71018);function a(t){return"undefined"!=typeof FormData&&t instanceof FormData}async function s(t){if((t.headers.get("content-type")||"").includes("application/json"))try{return await t.json()}catch(t){return null}try{return await t.text()}catch(t){return null}}async function u(t,e,r){try{let n={method:r,headers:function(t){let e=new Headers;a(t)||e.set("Content-Type","application/json"),e.set("ngrok-skip-browser-warning","43534");let r=localStorage.getItem(i.Uf);return r&&e.set("authorization","Bearer ".concat(r)),e}(e),body:"GET"===r?void 0:a(e)?e:null!=e?JSON.stringify(e):void 0},u=await fetch("http://192.168.22.193:8001"+t,n);if(401===u.status){localStorage.removeItem("_user"),localStorage.removeItem("jwt_access_token"),window.location.pathname.includes("login")||(window.location.href="/login");return}if(!u.ok){let t=await s(u);return new o({status:u.status,payload:t})}return await s(u)}catch(t){return console.log("\uD83D\uDE80 ~ callAPI ~ e:",t),new n(t)}}function c(t){return u(t,void 0,"GET")}function l(t){return u(t,void 0,"DELETE")}function p(t,e){return u(t,e,"POST")}function d(t,e){return u(t,e,"PUT")}},18935:function(t,e,r){var n=r(59625),o=r(19478);e.Z={login:t=>(0,o.yn)(n.Z.LOGIN,t),getUserInfo:()=>(0,o.Xt)(n.Z.USER_INFO)}},59625:function(t,e){e.Z={SUMMARIZATION:"/api/v1/summarization",INFERENCE:"/api/v1/inference",EMBEDDING:"/api/v1/embedding",OCR:"/api/v1/ocr",LOGIN:"/api/v1/auth/login",USER_INFO:"/api/v1/auth/user",GET_ORGANIZATIONS:"/api/v1/organizations/",CREATE_ORGANIZATION:"/api/v1/organizations/",UPDATE_ORGANIZATION:"/api/v1/organizations/",DELETE_ORGANIZATION:"/api/v1/organizations",GET_ORGANIZATION_BY_ID:"/api/v1/organizations",USER_ORGANIZATIONS:"/api/v1/user/organizations",GET_PROJECTS:"/api/v1/projects/setup/",PROJECTS:"/api/v1/projects/",PROJECT_BY_ORGANIZATION:"/api/v1/projects/by-organization",PROJECT_USAGE:"/api/v1/usage",PROJECT_SERVICES:"/api/v1/projects",USER_PROJECTS:"/api/v1/user/projects",GET_ALL_SERVICES:"/api/v1/services",GET_ALL_MODELS:"/api/v1/models",GET_ALL_PROVIDERS:"/api/v1/providers",GET_MODELS_BY_PROVIDER:"/api/v1/models/by-provider"}},68955:function(t,e,r){r.d(e,{V:function(){return n}});let n=(0,r(2265).createContext)(void 0);n.Consumer},99458:function(t,e,r){r.d(e,{w7:function(){return c},y1:function(){return u},yP:function(){return s}});var n=r(50591),o=r(33454),i=r(13270),a=r(18935);let s=async t=>{let{email:e,password:r}=t;try{let t=await a.Z.login({email:e,password:r});if(console.log("\uD83D\uDE80 ~ signInWithPassword ~ res:",t),!t||(null==t?void 0:t.success)!==!0)throw Error("Login failed");let{access_token:n,user:s}=t.data;if(!n)throw Error("Access token not found in response");n&&t&&t.success&&(sessionStorage.setItem(i.U,n),localStorage.setItem("_user",JSON.stringify(s)),(0,o.KY)(n))}catch(t){throw console.error("Error during sign in:",t),t}},u=async t=>{let{email:e,password:r,firstName:o,lastName:a}=t;try{let{accessToken:t}=(await n.ZP.post(n.Hv.auth.signUp,{email:e,password:r,firstName:o,lastName:a})).data;if(!t)throw Error("Access token not found in response");sessionStorage.setItem(i.U,t)}catch(t){throw console.error("Error during sign up:",t),t}},c=async()=>{try{await (0,o.KY)(null)}catch(t){throw console.error("Error during sign out:",t),t}}},13270:function(t,e,r){r.d(e,{U:function(){return n}});let n="jwt_access_token"},71018:function(t,e,r){r.d(e,{Ho:function(){return l},Uf:function(){return i.U},yP:function(){return o.yP},y1:function(){return o.y1}});var n=r(33454),o=r(99458),i=r(13270),a=r(57437),s=r(2265),u=r(98191),c=r(68955);function l(t){let{children:e}=t,{state:r,setState:o}=function(t){let[e,r]=(0,s.useState)(t),n=!(0,u.Xy)(e,t),o=(0,s.useCallback)(t=>{r(e=>({...e,...t}))},[]),i=(0,s.useCallback)((t,e)=>{o({[t]:e})},[o]),a=(0,s.useCallback)(()=>{r(t)},[t]);return(0,s.useMemo)(()=>({state:e,setState:o,setField:i,onResetState:a,canReset:n}),[n,a,i,o,e])}({user:null,loading:!0}),l=(0,s.useCallback)(async()=>{try{let t=localStorage.getItem(i.U);if(t&&(0,n.wu)(t)){(0,n.KY)(t);let{user:e}={user:{id:1,email:"",name:"John Doe",role:"admin"}};o({user:{...e,accessToken:t},loading:!1})}else o({user:null,loading:!1})}catch(t){console.error(t),o({user:null,loading:!1})}},[o]);(0,s.useEffect)(()=>{l()},[]);let p=r.user?"authenticated":"unauthenticated",d=r.loading?"loading":p,f=(0,s.useMemo)(()=>{var t,e;return{user:r.user?{...r.user,role:null!==(e=null===(t=r.user)||void 0===t?void 0:t.role)&&void 0!==e?e:"admin"}:null,checkUserSession:l,loading:"loading"===d,authenticated:"authenticated"===d,unauthenticated:"unauthenticated"===d}},[l,r.user,d]);return(0,a.jsx)(c.V.Provider,{value:f,children:e})}},33454:function(t,e,r){r.d(e,{KY:function(){return s},wu:function(){return a}});var n=r(50591),o=r(13270);function i(t){try{if(!t)return null;let e=t.split(".");if(e.length<2)throw Error("Invalid token!");let r=e[1].replace(/-/g,"+").replace(/_/g,"/");return JSON.parse(atob(r))}catch(t){throw console.error("Error decoding token:",t),t}}function a(t){if(!t)return!1;try{let e=i(t);if(!e||!("exp"in e))return!1;let r=Date.now()/1e3;return e.exp>r}catch(t){return console.error("Error during token validation:",t),!1}}async function s(t){try{if(t){localStorage.setItem(o.U,t),n.ZP.defaults.headers.common.Authorization="Bearer ".concat(t);let e=i(t);if(e&&"exp"in e)!function(t){let e=Date.now();setTimeout(()=>{try{sessionStorage.removeItem(o.U),window.location.href="/login"}catch(t){throw console.error("Error during token expiration:",t),t}},1e3*t-e)}(e.exp);else throw Error("Invalid access token!")}else localStorage.removeItem(o.U),delete n.ZP.defaults.headers.common.Authorization}catch(t){throw console.error("Error during set session:",t),t}}},50591:function(t,e,r){r.d(e,{Hv:function(){return o}});let n=r(38472).Z.create({baseURL:"http://192.168.22.193:8001"});n.interceptors.response.use(t=>t,t=>Promise.reject(t.response&&t.response.data||"Something went wrong!")),e.ZP=n;let o={chat:"/api/chat",kanban:"/api/kanban",calendar:"/api/calendar",auth:{me:"/api/auth/me",signIn:"/api/auth/sign-in",signUp:"/api/auth/sign-up"},mail:{list:"/api/mail/list",details:"/api/mail/details",labels:"/api/mail/labels"},post:{list:"/api/post/list",details:"/api/post/details",latest:"/api/post/latest",search:"/api/post/search"},product:{list:"/api/product/list",details:"/api/product/details",search:"/api/product/search"}}},98191:function(t,e,r){r.d(e,{VF:function(){return function t(e){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"children",n=[],o=null==e?void 0:e.map(t=>(t[r]&&t[r].length&&(n=[...n,...t[r]]),t));return null==o?void 0:o.concat(n.length?t(n,r):n)}},Xy:function(){return function t(e,r){if(null==e||null==r)return e===r;if(typeof e!=typeof r)return!1;if("string"==typeof e||"number"==typeof e||"boolean"==typeof e)return e===r;if(Array.isArray(e)&&Array.isArray(r))return e.length===r.length&&e.every((e,n)=>t(e,r[n]));if("object"==typeof e&&"object"==typeof r){let n=Object.keys(e),o=Object.keys(r);return n.length===o.length&&n.every(n=>t(e[n],r[n]))}return!1}}})}}]);